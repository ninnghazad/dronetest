-- jit.off(true) -- no effect?
local peripheral = sys.loadApi("peripheral")
local channel = "dronetest:drone:1"

local function shakeit(channel)
	local drone = peripheral.wrap(channel)
	print("DRONE "..channel.." GETTING DOWN NOW!")
	local r
	while true do
		--print("### 0 "..sys.id.." "..getId())
		sys.yield()

		if sys:receiveEvent({"input"}) ~= nil then
			print("RECEIVED INPUT, ABORT EPIC MOVES NOW!")
			break
		end

		r = math.random(0,5)
		
		if r == 0 then
		--	drone.forward()
		elseif r == 1 then
		--	drone.back()
		elseif r == 2 then
			drone.up()
		elseif r == 3 then
			drone.down()
		elseif r == 4 then
			drone.turnRight()
		else
			drone.turnLeft()
		end
		
		print("OHYEAH!")
	end
end

shakeit("dronetest:drone:1")



print("GOODBYE!!!!")
return true